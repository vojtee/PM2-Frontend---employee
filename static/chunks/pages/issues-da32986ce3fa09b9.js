(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[765],{3569:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return s(9749)}])},990:function(e,t,s){"use strict";s.d(t,{c:function(){return l}});var n=s(7294);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,s]=(0,n.useState)([]);(0,n.useEffect)(()=>{s([])},[e]);let l=(0,n.useCallback)(()=>{s([...e])},[e]),a=(0,n.useCallback)(e=>{s(t=>[...t,e])},[]),i=(0,n.useCallback)(()=>{s([])},[]),r=(0,n.useCallback)(e=>{s(t=>t.filter(t=>t!==e))},[]);return{handleDeselectAll:i,handleDeselectOne:r,handleSelectAll:l,handleSelectOne:a,selected:t}}},9749:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return H}});var n=s(5893),l=s(7294),a=s(9008),i=s.n(a),r=s(9140),c=s(7357),o=s(5582),d=s(6447),u=s(5861),h=s(4054),x=s(3321),m=s(3219),g=s(990),p=s(8334),j=s(5697),Z=s.n(j),f=s(6242),y=s(7906),b=s(3184),S=s(3816),v=s(8102),w=s(5071),C=s(295),k=s(3795),P=s(2613),D=s(9305),I=s(2377),E=s(4179),O=s(7556),_=s(9036);let N=e=>{let{count:t=0,items:s=[],onDeselectAll:l,onDeselectOne:a,onPageChange:i=()=>{},onRowsPerPageChange:r,onSelectAll:o,onSelectOne:h,page:x=0,rowsPerPage:m=0,selected:g=[]}=e,p=g.length>0&&g.length<s.length,j=s.length>0&&g.length===s.length,Z=e=>{switch(e){case"SOLVED":return(0,n.jsx)(E.Z,{});case"SOLVING":return(0,n.jsx)(O.Z,{});default:return(0,n.jsx)(_.Z,{})}};return(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(I.L,{children:(0,n.jsx)(c.Z,{sx:{minWidth:800},children:(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(b.Z,{children:(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(v.Z,{padding:"checkbox",children:(0,n.jsx)(w.Z,{checked:j,indeterminate:p,onChange:e=>{e.target.checked?null==o||o():null==l||l()}})}),(0,n.jsx)(v.Z,{children:"Name"}),(0,n.jsx)(v.Z,{children:"Status"})]})}),(0,n.jsx)(C.Z,{children:s.map(e=>{let t=g.includes(e.id);return(0,n.jsxs)(S.Z,{component:k.Z,href:"/issues/".concat(e.id),hover:!0,selected:t,children:[(0,n.jsx)(v.Z,{padding:"checkbox",children:(0,n.jsx)(w.Z,{checked:t,onChange:t=>{t.target.checked?null==h||h(e.id):null==a||a(e.id)}})}),(0,n.jsx)(v.Z,{children:(0,n.jsx)(d.Z,{alignItems:"center",direction:"row",spacing:2,children:(0,n.jsx)(u.Z,{variant:"subtitle2",children:"#".concat(e.id," | ").concat(e.title)})})}),(0,n.jsx)(v.Z,{children:(0,n.jsx)(P.Z,{title:e.status,children:Z(e.status)})})]},e.id)})})]})})}),(0,n.jsx)(D.Z,{component:"div",count:t,onPageChange:i,onRowsPerPageChange:r,page:x,rowsPerPage:m,rowsPerPageOptions:[5,10,25]})]})};N.propTypes={count:Z().number,items:Z().array,onDeselectAll:Z().func,onDeselectOne:Z().func,onPageChange:Z().func,onRowsPerPageChange:Z().func,onSelectAll:Z().func,onSelectOne:Z().func,page:Z().number,rowsPerPage:Z().number,selected:Z().array};var A=s(9396),U=s(7709),L=s(7109);let W=()=>(0,n.jsx)(f.Z,{sx:{p:2},children:(0,n.jsx)(U.Z,{defaultValue:"",fullWidth:!0,placeholder:"Search issue",startAdornment:(0,n.jsx)(L.Z,{position:"start",children:(0,n.jsx)(m.Z,{color:"action",fontSize:"small",children:(0,n.jsx)(A.Z,{})})}),sx:{maxWidth:500}})});var z=s(8355),V=s(6703),M=s(3340),R=s(431),G=s(6822);let T=[],B=(e,t)=>(0,l.useMemo)(()=>(0,z.i)(T,e,t),[e,t]),X=e=>(0,l.useMemo)(()=>e.map(e=>e.id),[e]),F=()=>{let e;let t=(0,G.Z)(),[s,a]=(0,l.useState)(null),[p,j]=(0,l.useState)([]),[Z,f]=(0,l.useState)([]),[y,b]=(0,l.useState)(null),[S,v]=(0,l.useState)(null),[w,C]=(0,l.useState)(0),[k,P]=(0,l.useState)(5),[D,I]=(0,l.useState)(""),[E,O]=(0,l.useState)(""),[_,A]=(0,l.useState)(""),U=B(w,k),L=X(U),z=(0,g.c)(L),T=async()=>{try{let e=await t.get("/api/v1/employees/me");b(e.data.uid),v(e.data.departmentUid)}catch(e){console.error("Error fetching my data:",e)}},F=e=>{let{name:t,value:s}=e.target;"status"===t&&I(s),"department"===t&&(""!=s&&q(S),O(s)),"employee"===t&&(""!=s&&J(y),A(s))},H=async()=>{try{let e=await t.get("/api/v1/issues"),s=e.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));a(s)}catch(e){console.error("Error fetching issues:",e)}},q=async e=>{try{let s=await t.get("/api/v1/issues/department/"+e),n=s.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));j(n)}catch(e){console.error("Error fetching issues by department:",e)}},J=async e=>{try{let s=await t.get("/api/v1/issues/employee/"+e),n=s.data.issues.map(e=>({id:e.id,photo:e.photo,coordinates:{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude},description:e.description,title:e.title,authorUid:e.authorUid,categoryId:e.categoryId,creationDate:e.creationDate,status:e.status,likeCount:e.likeCount}));f(n)}catch(e){console.error("Error fetching issues by me:",e)}};(0,l.useEffect)(()=>{let e=async()=>{await H(),await T()};e()},[]);let K=(0,l.useCallback)((e,t)=>{C(t)},[]),Q=(0,l.useCallback)(e=>{P(e.target.value)},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i(),{children:(0,n.jsx)("title",{children:"Issues"})}),(0,n.jsx)(c.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,n.jsx)(o.Z,{maxWidth:"xl",children:(0,n.jsxs)(d.Z,{spacing:3,children:[(0,n.jsx)(d.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:(0,n.jsxs)(d.Z,{spacing:1,children:[(0,n.jsx)(u.Z,{variant:"h4",children:"Issues"}),(0,n.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(M.Z,{id:"select-status-label",children:"Status"}),(0,n.jsxs)(V.Z,{labelId:"select-status-label",id:"select-status",value:D,label:"Status",name:"status",onChange:F,children:[(0,n.jsx)(R.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),(0,n.jsx)(R.Z,{value:"PUBLISHED",children:"Published"}),(0,n.jsx)(R.Z,{value:"SOLVING",children:"Solving"}),(0,n.jsx)(R.Z,{value:"SOLVED",children:"Solved"})]})]}),(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(M.Z,{id:"select-status-label",children:"Department"}),(0,n.jsxs)(V.Z,{labelId:"select-department-label",id:"select-department",value:E,label:"Department",name:"department",onChange:F,children:[(0,n.jsx)(R.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),(0,n.jsx)(R.Z,{value:"myDepartment",children:"My department"})]})]}),(0,n.jsxs)(h.Z,{sx:{m:1,minWidth:120},size:"small",children:[(0,n.jsx)(M.Z,{id:"select-status-label",children:"Employee"}),(0,n.jsxs)(V.Z,{labelId:"select-employee-label",id:"select-employee",value:_,label:"Employee",name:"employee",onChange:F,children:[(0,n.jsx)(R.Z,{value:"",children:(0,n.jsx)("em",{children:"None"})}),(0,n.jsx)(R.Z,{value:"me",children:"My issues"})]})]}),(0,n.jsx)(x.Z,{color:"inherit",startIcon:(0,n.jsx)(m.Z,{fontSize:"small",children:(0,n.jsx)(r.Z,{})}),href:"/issue-map",children:"Show on map"})]})]})}),(0,n.jsx)(W,{}),(0,n.jsx)(N,{count:s?s.length:0,items:s?(e=[...s],D&&(e=e.filter(e=>e.status===D)),E&&(e=e.filter(e=>p.some(t=>t.id===e.id))),_&&(e=e.filter(e=>Z.some(t=>t.id===e.id))),e):[],onDeselectAll:z.handleDeselectAll,onDeselectOne:z.handleDeselectOne,onPageChange:K,onRowsPerPageChange:Q,onSelectAll:z.handleSelectAll,onSelectOne:z.handleSelectOne,page:w,rowsPerPage:k,selected:z.selected})]})})})]})};F.getLayout=e=>(0,n.jsx)(p.A,{children:e});var H=F},6822:function(e,t,s){"use strict";var n=s(5121);let l=()=>{let e=n.Z.create({baseURL:"https://bettercity.mikita.dev",timeout:8e3,headers:{Authorization:"Bearer "+window.sessionStorage.getItem("token")}});return e};t.Z=l},8355:function(e,t,s){"use strict";function n(e,t,s){return e.slice(t*s,t*s+s)}s.d(t,{i:function(){return n}})}},function(e){e.O(0,[823,549,837,703,28,258,879,612,334,774,888,179],function(){return e(e.s=3569)}),_N_E=e.O()}]);